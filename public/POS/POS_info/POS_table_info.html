<!-- 적용버튼으로 쿼리 변경 -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-storage.js"></script>
    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyBzWGqNmb6KazuZB_ykjg1zkS-YWSaFFBk",
            authDomain: "store-reservation-system.firebaseapp.com",
            projectId: "store-reservation-system",
            storageBucket: "store-reservation-system.appspot.com",
            messagingSenderId: "734537126957",
            appId: "1:734537126957:web:5d84d462476d77ddbbd4a4"
        };
        firebase.initializeApp(firebaseConfig);
    </script>
    <title>테이블 관리</title>
</head>

<body>
    <div id="table"></div>
    <div>
        <button class="table_btn" id="add_table">테이블 추가</button>
        <button class="table_btn" id="del_table">테이블 삭제</button>
        <button class="table_btn" id="change_apply">변경사항 적용</button>
        <button class="table_btn" id="change_calcel">변경 취소</button>
        <p id="table"></p>
        <p id="count"></p>
    </div>
    <script>
        var table_num
        var count
        const db = firebase.firestore();
        const table = document.getElementById('table');
        const count_table = document.getElementById('count');

        function get_table(){
            db.collection("테스트").get().then((result) => {
                result.forEach((doc) => {
                    table_num = doc.data().테이블갯수;
                    console.log(table_num);
                })
                //table_num;
                table.innerHTML = "테이블 갯수 : " + table_num;
                count = 0;
            }).catch((err) => {
                console.log(err);
            })          
        };
        get_table();

        $("#add_table").click(function () {
            count++;
            count_table.innerHTML = "변경 할 테이블 갯수 : " + count;
        })

        $("#del_table").click(function () {
            count--;
            count_table.innerHTML = "변경 할 테이블 갯수 : " + count;
        })

        $("#change_apply").click(function (){
            if(count<0){ // 삭제
                for(var i = count; i++; i<0){
                    db.collection("테스트").doc("test").collection("테이블정보").doc(String(table_num)).delete({
                    })
                    table_num--;
                }
                db.collection("테스트").doc("test").update({
                테이블갯수: table_num
            })
            }
            else if(count>0){ // 추가
                for(var i = count; i--; i>0){
                    table_num++;
                    db.collection("테스트").doc("test").collection("테이블정보").doc(String(table_num)).set({

                    })  
                }
                db.collection("테스트").doc("test").update({
                테이블갯수: table_num
            })
            }
            else{

            }
            table.innerHTML = "테이블 갯수 : " + table_num;
            count = 0;
            count_table.innerHTML = "변경 할 테이블 갯수 : " + count;
        })

        $("#change_calcel").click(function (){
            count = 0;
            count_table.innerHTML = "변경 할 테이블 갯수 : " + count;
        })

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
</body>

</html>